---
title: "group project"
format: html
editor: visual
---

```{r}
# how to load the data
# data_obj <- "https://arcticdata.io/metacat/d1/mn/v2/object/urn%3Auuid%3A9e123f84-ce0d-4094-b898-c9e73680eafa"
# path <- "~/api-practice"
# 
# download_d1_data(data_obj,
#                  path)
```

### Load in Data from EDI

```{r}
library(tidyverse)
library(metajam)
```

```{r}
## loaded data into group project folder

#Q1_data <- "https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-luq.20.4923061&entityid=96e0ef7b3f2bc92485a559645d545845"
#Q2_data <-"https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-luq.20.4923061&entityid=8d1e2d357a2dc2d56b9eedea56a46236"
#Q3_data <- "https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-luq.20.4923061&entityid=665f37efee3109a7c3aff95e079e2de2"
#RPM_data <- "https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-luq.20.4923061&entityid=acb18d969cf36e7efda2604a1449e816"

#path <- "/courses/EDS214/group_project/team_siguana"

#download_d1_data(Q1_data, path)
#download_d1_data(Q2_data, path)
#download_d1_data(Q3_data, path)
#download_d1_data(RPM_data, path)
```

# Reading in the Water Chemistry Stream Data

```{r}
#Reading in all datasets into a list
q1_data <- read_d1_files("/courses/EDS214/group_project/team_siguana/https_pasta.lternet.edu_package_metadata_eml_knb-lter-luq_20_4923061__QuebradaCuenca1-Bisley__csv")
q2_data <- read_d1_files("/courses/EDS214/group_project/team_siguana/https_pasta.lternet.edu_package_metadata_eml_knb-lter-luq_20_4923061__QuebradaCuenca2-Bisley__csv")
q3_data <- read_d1_files("/courses/EDS214/group_project/team_siguana/https_pasta.lternet.edu_package_metadata_eml_knb-lter-luq_20_4923061__QuebradaCuenca3-Bisley__csv")
prm <- read_d1_files("/courses/EDS214/group_project/team_siguana/__RioMameyesPuenteRoto__csv")

#Make the data into dataframes
q1_data_df <- q1_data$data
q2_data_df <- q2_data$data
q3_data_df <- q3_data$data
prm_data <- prm$data

q1_attribute_metadata <- q1_data$attribute_metadata
```

## Data for Remaking Graph

```{r}
# select columns of interest: K, NO3-N, Sample_Date, Sample_ID
hugo_data <- q1_data_df %>% 
  full_join(q2_data_df) %>% 
  full_join(q3_data_df) %>% 
  full_join(prm_data) %>% 
  select(Sample_ID, Sample_Date, K, `NO3-N`)
```

## Plot

```{r}
# Wrangling data for plot 
hugo_plot <- hugo_data %>% 
  pivot_longer(cols = c(3,4)) %>% 
  mutate(year = as.numeric(format(Sample_Date,'%Y'))) %>% 
  filter(year %in% c(1988:1995))

# Remaking the plot
ggplot(hugo_plot, aes(Sample_Date, value)) +
  geom_line(aes(color = Sample_ID)) +
  facet_wrap(~name, 
             scales =  "free", 
             ncol = 1,  
             strip.position = "left",  
             labeller = as_labeller(c("NO3-N" = "NO3-N ug/L", "K" = "K mg/L"))) + 
  labs(title = "Chemical concentrations in streams", 
       x = "Year",
       y = "", 
       color = "Site") +
  scale_color_manual(breaks = c("MPR", "Q1", "Q2", "Q3"),
                        values=c("gray48", "cornflowerblue", "pink", "palegreen3")) +
  theme_minimal() +
  geom_vline(xintercept = as.numeric(as.Date("1989-09-09")), 
             linetype=4) +
  theme(plot.title = element_text(face="bold", size = 14)) +
  theme(axis.title = element_text(face = "bold")) +
  theme(strip.text = element_text(face = "bold", size = 10)) 
```

# Read in Hurricane Maria NOAA data

How long does it take for the stream composition to get back to baseline after two major hurricanes in Puerto Rico: Hurricane Hugo in 1989, and Hurricane Maria in 2017.

-   Is there a difference between the two hurricanes?

-   gage ht; chemical composition

-   compare three locations to see where the hurricanes hit hardest?

```{r}
# read in hurricane maria data
```
